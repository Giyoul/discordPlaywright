# discord-content-hub

## 📋 목차

- [프로젝트 소개](#프로젝트-소개)
- [As-Is \| To-Be](#as-is--to-be)
- [주요 기능](#주요-기능)
- [프로젝트 구조](#프로젝트-구조)
- [기술 스택](#기술-스택)
- [기능 요구사항](#기능-요구사항)
- [구현 기능 목록](#구현-기능-목록)
- [커밋 컨벤션](#커밋-컨벤션)

---

## 프로젝트 소개

### 서비스 링크
> https://contents-hub-j89f.vercel.app/

### 프런트 repository
> https://github.com/Giyoul/contents-hub.git

### 문제 정의

> 순수한 의도의 적극적인 지식 공유 및 토론 활동이 일부 참가자의 심리적 위축과 오해를 유발하며, 궁극적으로 함께 성장하는 지식 선순환이라는 핵심 가치를 훼손시키고 중도 이탈자를 발생시킨다.

### 타겟 사용자

> 커뮤니티 활동에 참여하고 싶으나, 배경지식의 부재로 무엇을 공부해야 하는지 혼란스러워하며 참여를 주저하는 참가자들.

### 솔루션

> 디스코드 커뮤니티의 '토론하기' 채널에 올라온 글들을 자동/반자동으로 **주제별·기초 난이도별로 분류**하고, 각 글을 이해하기 위한 **필수 선수 지식 → 참고 자료 링크 → 해당 토론 글 링크**를 단계적으로 안내하는 "단계별 학습 가이드 허브"를 제공한다.

### 목표

- 심리적 위축을 느끼던 참가자들도 **스스로 필요한 지식을 파악하고 학습할 수 있게** 돕는 것
- 당장 토론 참여를 못 하더라도, **언제든 학습을 재개할 수 있는 경로**를 제시하는 것
- 궁극적으로는 **지식 선순환 커뮤니티의 활성화**

---

## As-Is | To-Be

### As-Is

| **분류** | **내용** |
| --- | --- |
| **정보 접근성** | **토론 참여를 위한 선수 지식**이 체계적으로 정리되어 있지 않아, **무엇을** 공부해야 할지 알기 어렵다. |
| **학습 과정** | 활발한 토론 내용을 접했을 때, 이해를 위해 필요한 지식을 **스스로 방대한 자료 속에서 일일이 찾아야** 하는 **시간 소모**와 **비효율성**이 크다. |
| **심리적 상태** | 학습 진입 장벽이 높아 보이는 커뮤니티 분위기에 **압도당하고 낙담**하여, 토론에 참여할 **자신감을 잃고 소극적인 태도**를 취하게 된다. |
| **결과** | **성장 기회를 놓치고**, 지식 공유의 선순환에 합류하지 못하며, 잠재적으로 **중도 포기**를 고려할 위험이 높다. |

### To-Be

| **분류** | **내용** |
| --- | --- |
| **정보 접근성** | **토론 글/토픽별 필수 선수 지식**을 엄선된 학습 자료(블로그 링크 등)로 **원클릭 접근**할 수 있도록 **체계적인 허브**가 마련된다. |
| **학습 과정** | "이 토론을 이해하기 위해선 이것부터 보세요"라는 명확한 가이드라인을 통해 **효율적이고 단계적인 학습 경로**를 제공받아, 학습 효율이 극대화된다. |
| **심리적 상태** | 학습의 **첫걸음**을 쉽게 떼고, 토론 내용을 **점진적으로 이해**하게 되면서 **자신감을 회복**하고 **적극적인 참여 의지**를 갖게 된다. |
| **결과** | 지식의 선순환 고리에 **쉽게 진입**하고, **함께 성장하는 동료**로서 긍정적인 커뮤니티 활동에 기여하게 된다. |

---

## 주요 기능

### 1. 콘텐츠 수집 및 분류 기능

- 디스코드 '토론하기' 채널의 글을 **반자동으로 수집** (사용자가 브라우저에서 글 클릭)
- **두 가지 스크래핑 모드 제공**:
  - **자동 분류 모드**: 스크래핑할 때마다 즉시 AI 분류 수행
  - **배치 분류 모드**: 스크래핑만 수행하고 분류는 나중에 일괄 처리
- **AI 기반 자동 분류**: Gemini API를 활용하여 글을 주제별로 자동 분류
- 글을 다음 기준으로 분류:
  - **상위 카테고리**: 공통 / BE / FE / AN
  - **하위 카테고리**: 기본 설계 / 검증 / ... 세부 카테고리
- 적합한 카테고리가 없는 경우 새로운 카테고리 제안

### 2. 배치 분류 기능

- **효율적인 API 사용**: 여러 글을 모아 한 번에 분류하여 API 비용 절감
- **빠른 데이터 수집**: 스크래핑 시 대기 시간 없이 빠르게 수집 가능
- **일괄 처리**: 수집된 모든 원본 데이터를 한 번에 분류
- **진행 상황 표시**: 배치 분류 진행 상황 및 성공/실패 통계 제공

### 3. 데이터 저장 기능

- 스크래핑된 글을 **CSV 파일로 저장**
- 저장 정보:
  - 제목 (Discord 스레드 제목)
  - 설명 (AI가 생성한 30자 요약)
  - 링크 (전체보기 페이지 URL)
  - 작성자
  - Post ID (매칭된 카테고리 ID)

### 4. 사용자 인터페이스

- **CLI 기반 인터페이스**로 간단하고 직관적인 사용
- 실시간 스크래핑 진행 상황 표시
- 분류 결과 및 저장 완료 알림

---

## 프로젝트 구조

```
scrape/
├── main.py                          # 프로그램 진입점
│
├── config.py                        # 설정 파일 (API 키, URL 등)
│
├── controller/                      # 컨트롤러 레이어
│   └── app_controller.py           # 애플리케이션 흐름 제어
│
├── service/                         # 서비스 레이어
│   ├── scraper_service.py          # Discord 스크래핑 서비스
│   ├── classification_service.py   # AI 분류 서비스 (Gemini)
│   └── save_service.py             # CSV 저장 서비스
│
├── view/                            # 뷰 레이어
│   └── cli_view.py                 # CLI 인터페이스
│
├── data/                            # 데이터 파일
│   └── posts.json                  # Post 카테고리 데이터
│
└── requirements.txt                 # Python 패키지 의존성
```

### 아키텍처 구조

```
main.py (진입점)
  ↓
AppController (흐름 제어)
  ├── CLIView (사용자 인터페이스)
  ├── ScraperService (스크래핑)
  │   └── ClassificationService (AI 분류)
  └── SaveService (CSV 저장)
      └── ScraperService (데이터 조회)
```

### 레이어별 역할

- **Controller**: 사용자 입력 처리 및 서비스 간 흐름 제어
- **Service**: 비즈니스 로직 처리
  - `ScraperService`: Playwright를 사용한 Discord 스크래핑
  - `ClassificationService`: Gemini API를 사용한 글 분류
  - `SaveService`: 스크래핑 데이터를 CSV로 저장
- **View**: 사용자 인터페이스 (CLI)
- **Data**: 정적 데이터 (Post 카테고리 목록)

---

## 기술 스택

### 언어 및 런타임

- **Python 3.12+** - 메인 프로그래밍 언어

### 주요 라이브러리

- **Playwright** - 브라우저 자동화 및 웹 스크래핑
  - Chromium 브라우저 제어
  - 동적 콘텐츠 로딩 대기
  - DOM 요소 선택 및 데이터 추출

- **Google Generative AI (Gemini)** - AI 기반 텍스트 분류
  - `gemini-2.5-flash` 모델 사용
  - JSON 형식 응답 파싱
  - 카테고리 매칭 및 요약 생성

- **Pandas** - 데이터 처리 및 CSV 저장
  - DataFrame 생성 및 조작
  - CSV 파일 생성 (UTF-8 BOM 인코딩)

### 기타 라이브러리

- **requests** - HTTP 요청 (미사용)
- **beautifulsoup4** - HTML 파싱 (미사용)
- **browser-cookie3** - 브라우저 쿠키 추출 (미사용)

### 개발 환경

- **가상환경 (venv)** - 프로젝트별 패키지 격리
- **CLI 인터페이스** - 터미널 기반 사용자 인터페이스

---

## 기능 요구사항

### Functional Requirements

#### 1. 콘텐츠 수집 기능

- [x] 디스코드 '토론하기' 채널 접근
- [x] 사용자가 브라우저에서 글을 클릭하면 자동으로 스크래핑 시작
- [x] 스레드 전체보기 페이지로 자동 이동
- [x] 원본 글 및 모든 댓글 추출
- [x] Discord 스레드 제목 추출
- [x] 작성자 정보 추출
- [x] 중복 스크래핑 방지 (URL 기반)

#### 2. AI 기반 분류 기능

- [x] Gemini API를 사용한 글 분류
- [x] Post 카테고리 목록과 매칭
- [x] 30자 이내 요약 생성
- [x] 적합한 카테고리가 없는 경우 새로운 카테고리 제안
- [x] JSON 형식 응답 파싱
- [x] 자동 분류 모드 (즉시 분류)
- [x] 배치 분류 모드 (일괄 분류)

#### 3. 데이터 저장 기능

- [x] 스크래핑된 데이터를 CSV 파일로 저장
- [x] 타임스탬프가 포함된 파일명 생성
- [x] UTF-8 BOM 인코딩으로 한글 지원
- [x] 저장된 데이터 개수 표시

#### 4. 배치 분류 기능

- [x] 배치 분류 모드로 스크래핑 (원본 데이터만 저장)
- [x] 수집된 원본 데이터 일괄 분류
- [x] 배치 분류 진행 상황 표시
- [x] 성공/실패 통계 제공

#### 5. 사용자 인터페이스

- [x] CLI 기반 메뉴 시스템
  - [x] 자동 분류 모드 스크래핑
  - [x] 배치 분류 모드 스크래핑
  - [x] 배치 분류 실행
  - [x] CSV 저장
- [x] 스크래핑 진행 상황 실시간 표시
- [x] 분류 결과 출력
- [x] 에러 메시지 및 알림 표시
- [x] 'end' 명령어로 스크래핑 종료

### Non-Functional Requirements

#### 사용성

- [x] 간단하고 직관적인 CLI 인터페이스
- [x] 명확한 진행 상황 피드백
- [x] 에러 발생 시 상세한 오류 메시지

#### 확장성

- [x] 새로운 Post 카테고리 추가 가능 (JSON 파일 기반)
- [x] 서비스 레이어 분리로 기능 확장 용이
- [x] MVC 패턴 적용으로 유지보수성 향상

#### 제약 조건

- [x] 수동 로그인 방식 (자동 로그인 제거)
  - 사용자가 브라우저에서 직접 로그인
  - 로그인 완료 후 스크래핑 진행
- [x] Gemini API 키 필요 (환경 변수 또는 config 파일)
- [x] Playwright 브라우저 설치 필요

---

## 구현 기능 목록

### 1. 스크래핑 기능

- [x] Playwright 브라우저 자동화
  - [x] Chromium 브라우저 실행
  - [x] 사용자 에이전트 설정
  - [x] 페이지 네비게이션
  - [x] 동적 콘텐츠 로딩 대기

- [x] Discord 스레드 감지
  - [x] URL 변경 감지
  - [x] `/thread/` 또는 `/threads/` 패턴 인식
  - [x] 중복 스크래핑 방지

- [x] 데이터 추출
  - [x] Discord 스레드 제목 추출
  - [x] 원본 글 내용 추출
  - [x] 댓글 목록 추출
  - [x] 작성자 정보 추출
  - [x] 전체보기 URL 변환

- [x] 스크롤 처리
  - [x] 모든 댓글 로드하기 위한 자동 스크롤
  - [x] 새 콘텐츠 로딩 감지

### 2. AI 분류 기능

- [x] Gemini API 연동
  - [x] API 키 설정
  - [x] 모델 초기화 (`gemini-2.5-flash`)
  - [x] 프롬프트 생성
  - [x] JSON 형식 응답 요청

- [x] 분류 로직
  - [x] Post 카테고리 데이터 로드
  - [x] 스크래핑 데이터와 카테고리 매칭
  - [x] Post ID 매칭
  - [x] 30자 요약 생성
  - [x] 새로운 카테고리 제안 (매칭 실패 시)

- [x] 응답 처리
  - [x] JSON 파싱
  - [x] 에러 처리
  - [x] 결과 객체 생성

- [x] 배치 분류 기능
  - [x] 자동 분류 모드 / 배치 분류 모드 선택
  - [x] 원본 데이터 저장 (`raw_scraped_data`)
  - [x] 분류된 데이터 저장 (`cached_posts`)
  - [x] 배치 분류 실행 메서드
  - [x] 배치 분류 진행 상황 및 통계 표시

### 3. 데이터 저장 기능

- [x] CSV 파일 생성
  - [x] Pandas DataFrame 생성
  - [x] 타임스탬프 파일명 생성
  - [x] UTF-8 BOM 인코딩
  - [x] 컬럼: title, description, link, author, post_id

- [x] 데이터 검증
  - [x] 저장할 데이터 존재 여부 확인
  - [x] 빈 데이터 처리

### 4. 사용자 인터페이스

- [x] CLI 메뉴 시스템
  - [x] 웰컴 메시지
  - [x] 메인 메뉴
    - [x] 자동 분류 모드 스크래핑
    - [x] 배치 분류 모드 스크래핑
    - [x] 배치 분류 실행
    - [x] CSV 저장
    - [x] 종료
  - [x] 사용자 입력 처리
  - [x] 에러 메시지 표시

- [x] 진행 상황 표시
  - [x] 스크래핑 시작/진행 알림
  - [x] 분류 결과 출력
  - [x] 배치 분류 진행 상황 (N/총개수)
  - [x] 배치 분류 성공/실패 통계
  - [x] 저장 완료 알림
  - [x] 카테고리 미매칭 알림

### 5. 코드 품질

- [x] MVC 패턴 적용
- [x] 서비스 레이어 분리
- [x] 에러 처리 및 예외 처리
- [x] 코드 주석 및 문서화
- [x] 중복 코드 제거

---

## 커밋 컨벤션

Following convention : https://gist.github.com/stephenparish/9941e89d80e2bc58a153

```markdown
# basic structure
<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>

# <type>
feat (feature)
fix (bug fix)
docs (documentation)
style (formatting, missing semi colons, …)
refactor
test (when adding missing tests)
chore (maintain)

# <scope>
console - I/O
domain - 핵심 로직
validation - 유효성검사
test - 테스트코드 추가
```